diff --git a/libfreerdp-core/update.c b/libfreerdp-core/update.c
index c828b2214..5af9f6ab1 100644
--- a/libfreerdp-core/update.c
+++ b/libfreerdp-core/update.c
@@ -90,7 +90,7 @@ void update_read_bitmap(rdpUpdate* update, STREAM* s, BITMAP_UPDATE* bitmap_upda
 
 	if (bitmap_update->number > bitmap_update->count)
 	{
-		uint16 count;
+		uint32 count;
 
 		count = bitmap_update->number * 2;
 

